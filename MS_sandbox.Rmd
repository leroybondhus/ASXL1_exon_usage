---
title: "MS_sandbox"
output: html_document
date: '2022-10-12'
---

```{r}

library(ggplot2)
library(tidyverse)
library(ggrepel)
library(reshape)

# import gtex data

temp <- tempfile()
download.file("https://storage.googleapis.com/gtex_analysis_v9/long_read_data/quantification_gencode.tpm.txt.gz", temp)
gtex <- read.table(temp, skip=0, header = TRUE, sep = "\t")
gtex_rowinfo <- data.frame(Name=gtex$Name, Description=gtex$Description)
rownames(gtex) <- gtex$transcript

```


```{r}

# create data frame to organize variables
df <- data.frame(GTEX.1192X.0011.R10a.SM.4RXXZ = gtex$GTEX.1192X.0011.R10a.SM.4RXXZ,
                 GTEX.11H98.0011.R11b.SM.4SFLZ = gtex$GTEX.11H98.0011.R11b.SM.4SFLZ)
# sort data
df <- melt(df)

# boxplot that compares the distribution of transcript expression of 2 gene samples
ggplot(data = df, mapping = aes(x = variable, y = log10(value))) + 
  geom_boxplot() + 
  labs(x = "Sample ID", y = "Quantification in TPM")

```


```{r}

# scatterplot comparing the expression of each transcript for 2 gene samples

ggplot(point_df, mapping = aes(x = log10(gtex$GTEX.1192X.0011.R10a.SM.4RXXZ), 
                               y = log10(gtex$GTEX.11H98.0011.R11b.SM.4SFLZ))) + 
  geom_point(size = 0.5) + 
  labs(x = "GTEX.1192X.0011.R10a.SM.4RXXZ", y = "GTEX.11H98.0011.R11b.SM.4SFLZ") +
  geom_smooth(method = 'lm')


```


```{r}

# histogram
# for colour scheme, val typically prefers greyscale. or, this red/blue combo she seems fine with too

hist(gtex$GTEX.11H98.0011.R11b.SM.4SFLZ, breaks=100,
main = "Frequency of quantifications in sample \n GTEX.11H98.0011.R11b.SM.4SFLZ", 
xlab = "Quantification in TPM", ylab = "Frequency",
xlim = c(0,2000))

order(gtex$GTEX.11H98.0011.R11b.SM.4SFLZ)


```


```{r}

# volcano plot


```

